---
inline:
  _source:
    excludes: [ "complete_names" ]
  query:
    function_score:
      query:
        dis_max:
          queries:
          - multi_match:
              query: "{{name}}"
              fields:
              - alternativeName
          - match_phrase:
              name: "{{name}}"
          - multi_match:
              query: "{{name}}"
              fields:
              - charityNumber
              - companyNumber
      functions:
      - filter:
          match_phrase_prefix:
            name: "{{name}}"
        weight: 200
      - filter:
          multi_match:
            query: "{{name}}"
            fields:
            - alternativeName
            operator: and
        weight: 10
      - filter:
          term:
            active: false
        weight: 0.9
      - field_value_factor:
          field: latestIncome
          modifier: log2p
          missing: 1
  aggs:
    org_types:
      terms:
        field: organisationType.keyword
        size: 10
params:
  name: term
  charity_number: term
  domain_name: term
